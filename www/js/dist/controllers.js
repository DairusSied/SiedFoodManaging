!function(){"use strict";function o(o,e,t,n,a,i,r,s,c,u){function d(){w.dias=1,l()}function l(){a.show(),w.caixa=[],w.movimento=[],w.resumoMovimento=[],w.resumoVendas=[],w.balancete=[],w.cancelamentos=[],w.totalCancelamentos="",w.listagem=!0,r.async("GetTurno/"+w.dias).then(function(o){a.show({template:"Carregando Turnos"}),w.dados=o,i(function(){a.hide()},1e3)})}function m(){a.show(),w.movimento=[],r.async("GetMovimentoDoTurno/"+w.caixa.ID_CAIXA+"/"+w.caixa.TURNO).then(function(o){a.show({template:"Carregando Movimentos do Turno"}),w.movimento=o,i(function(){a.hide()},1e3)})}function p(){a.show(),w.resumoMovimento=[],r.async("GetResumoDoMovimentoDoTurno/"+w.caixa.ID_CAIXA+"/"+w.caixa.TURNO).then(function(o){a.show({template:"Carregando Resumo dos Movimentos do Turno"}),w.resumoMovimento=o,i(function(){a.hide()},1e3)})}function f(){a.show(),w.resumoVendas=[],r.async("GetResumoDaVendaDoTurno/"+w.caixa.ID_CAIXA+"/"+w.caixa.TURNO).then(function(o){a.show({template:"Carregando Resumo das Vendas do Turno"}),w.resumoVendas=o,i(function(){a.hide()},1e3)})}function h(){a.show(),w.balancete=[],r.async("GetBalanceteDoTurno/"+w.caixa.ID_CAIXA+"/"+w.caixa.TURNO).then(function(o){a.show({template:"Carregando Balancete do Turno"}),w.balancete=o,i(function(){a.hide()},1e3)})}function v(){a.show(),w.cancelamentos=[],r.async("GetCancelamentoNoTurno/"+w.caixa.ID_CAIXA+"/"+w.caixa.TURNO).then(function(o){if(a.show({template:"Carregando Cancelamentos do Turno"}),c.ContarObjetos(o[0])>0){var e=x(o);w.cancelamentos=o,w.totalCancelamentos=u.ConverterParaString(e.toFixed(2))}i(function(){a.hide()},1e3)})}function g(e){w.listagem=!1,w.caixa=e,w.datahora=s.RetornarDataHora(),o.when(w.caixa).then(m()).then(p()).then(f()).then(h()).then(v())}function C(){w.dias=w.data.dias,l()}function b(){w.data={},w.data.dias=1;S()}function I(){var o='<label class="item item-input">';return o+='<span class="input-label">Dias: </span>',o+='<input type="text" ng-model="vm.data.dias" readonly>',o+="</label>",o+='<div class="item range range-positive">',o+='<i class="icon ion-ios-minus"></i>',o+='<input type="range" min="1" max="31" ng-model="vm.data.dias">',o+='<i class="icon ion-ios-plus"></i>',o+="</div>"}function S(){return n.show({template:I(),title:"Informar os Dias",scope:t,buttons:[{text:"<b>Processar Relatório</b>",type:"button-balanced",onTap:function(o){w.data.dias?C():o.preventDefault()}}]})}function x(o){for(var e=o[0],t=c.ContarObjetos(e),n=0,a=0,i=0;i<t;)a=u.ConverterParaFloat(e[i].VALOR),n+=a,i++;return n}var w=this;w.listagem=!0,w.titulo="Relação de Caixas",w.dias="",w.datahora="",w.dataInicial="",w.totalCancelamentos="",w.movimento=[],w.resumoMovimento=[],w.resumoVendas=[],w.balancete=[],w.cancelamentos=[],w.dados=[],w.init=d,w.GetTurno=l,w.GerarRelatorio=g,w.ProcessarRelatorio=C,w.SelecionarDias=b,w.TemplateSelecionarDias=I,w.PopUpSelecionarDias=S,t.$on("EventLogin",d())}angular.module("sied.controllers").controller("CaixaCtrl",o),o.$inject=["$q","$log","$scope","$ionicPopup","$ionicLoading","$timeout","ClientAPIFactory","TratarDataService","TratarObjetosService","TratarFloatService"]}(),function(){"use strict";function o(o,e,t,n,a,i,r,s){function c(){g.nivel=s.getNivel(),d()}function u(){g.comandas=[],g.comanda="",g.tipo="",g.item="",g.index="",g.codigo="",g.relatorio=!0,d()}function d(){a.show(),g.relatorio=!0,o.when(g.relatorio).then(function(){l()}).then(function(){m()})}function l(){a.show(),g.mesas=[],r.async("GetRetornaMesasEmMovimento").then(function(o){a.show({template:"Carregando Movimento das Mesas"}),g.mesas=o,t(function(){a.hide()},1e3)})}function m(){a.show(),g.cartoes=[],r.async("GetRetornaCartoesEmMovimento").then(function(o){a.show({template:"Carregando Movimento dos Cartões"}),g.cartoes=o,t(function(){a.hide()},1e3)})}function p(o,e){a.show(),g.comanda=o,g.tipo=e,g.relatorio=!1,g.comandas=[],r.async("GetRetornaItensDaComanda/"+o+"/"+e).then(function(o){a.show({template:"Carregando Itens da Comanda"}),g.comandas=o,t(function(){a.hide()},1e3)})}function f(o,e,t){return i.show({title:"Atenção",template:"Deseja excluir esse item?",buttons:[{text:"Não",type:"button-calm"},{text:"<b>Sim</b>",type:"button-assertive",onTap:function(n){n&&(g.item=o,g.index=e,g.codigo=t,v())}}]})}function h(o,e,t){f(o,t,e)}function v(){a.show(),r.async("GetCancelaItemDaComanda/"+g.item+"/"+g.codigo+"/"+g.comanda+"/"+g.tipo+"/2").then(function(o){a.show({template:"Removendo Item"}),g.comandas[0].splice(g.index,1),g.item="",g.index="",t(function(){a.hide(),0==g.comandas[0].length&&u()},1e3)})}var g=this;g.titulo="Cancelamento de itens",g.relatorio=!1,g.mesas=[],g.cartoes=[],g.comandas=[],g.comanda="",g.item="",g.index="",g.tipo="",g.codigo="",g.nivel="",g.init=c,g.Voltar=u,g.CarregarItemsEmMovimento=d,g.RetornaMesasEmMovimento=l,g.RetornaCartoesEmMovimento=m,g.RetornaItemsDaComanda=p,g.EnviarCancelamento=h,g.RemoverItemDaComanda=v,n.$on("EventLogin",c())}angular.module("sied.controllers").controller("CancelamentosCtrl",o),o.$inject=["$q","$log","$timeout","$scope","$ionicLoading","$ionicPopup","ClientAPIFactory","UsuarioFactory"]}(),function(){"use strict";function o(o,e,t,n,a){function i(){r()}function r(){n.show(),l.dados=[],a.async("GetRetornaProdutoPorPrecoCompra").then(function(o){n.show({template:"Carregando Produtos pelo preço de compra"}),l.dados=o,l.relatorio=!0,e(function(){n.hide()},1e3)})}function s(o){n.show(),l.cabecalho=[],a.async("GetRetornaCompraCabecalhoItem/"+o.Codigo).then(function(o){n.show(),l.cabecalho=o,e(function(){n.hide()},1e3)})}function c(o){n.show(),l.detalhes=[],a.async("GetRetornaCompraItem/"+o.Codigo).then(function(o){n.show(),l.detalhes=o,e(function(){n.hide()},1e3)})}function u(e){n.show(),l.relatorio=!1,o.when(l.relatorio).then(s(e)).then(c(e))}function d(){l.cabecalho=[],l.detalhes=[],l.relatorio=!0,n.show(),e(function(){n.hide()},1e3)}var l=this;l.titulo="Compras",l.relatorio=!1,l.dados=[],l.cabecalho=[],l.detalhes=[],l.init=i,l.Voltar=d,l.RetornarProdutosByPrecoCompra=r,l.RetornarDetalhesDoItem=u,t.$on("EventLogin",i())}angular.module("sied.controllers").controller("ComprasCtrl",o),o.$inject=["$q","$timeout","$scope","$ionicLoading","ClientAPIFactory"]}(),function(){"use strict";function o(o,e,t,n,a,i,r,s,c,u){function d(){I.mensagem=[],i.show(),t.when(I.mensagem).then(function(){s.initDB()}).then(function(){c.initDB()}).then(function(){s.allServidores().then(function(o){I.servidores=o}).then(function(){n(function(){i.hide()},1e3)})})}function l(){if(i.show(),I.mensagem=[],!I.Ip)return I.mensagem[0]="Nenhum IP foi especificado",n(function(){i.hide()},1e3),!1;t.when(I.Ip).then(function(){s.findByValue(I.Ip).then(function(o){var e=o.Ip+":"+o.Porta;return u.setConfig(e),e}).then(function(o){return I.servidor={},I.Ip="",o}).then(function(o){c.limparServidores().then(function(){var t=new Date,a=""+t.getDay()+t.getMonth()+t.getFullYear()+t.getHours()+t.getMinutes()+t.getSeconds();c.addServidor({_id:a,servidor:o}).then(function(o){e.location.reload(!0)}).then(function(){n(function(){i.hide()},1e3)})})}).catch(function(e){I.Ip="",I.servidor={},o.info("ConfigCtrl: selecionar()"),o.error(e)})})}function m(){I.mensagem=[],I.servidor={Ip:"",Porta:"8080"};C()}function p(){i.show(),h(),I.mensagem.length>0||t.when(I.servidor).then(function(){I.Ip=I.servidor.Ip}).then(function(){var o=new Date,e=""+o.getDay()+o.getMonth()+o.getFullYear()+o.getHours()+o.getMinutes()+o.getSeconds();I.servidor={_id:e,Ip:I.servidor.Ip,Porta:I.servidor.Porta},s.addServidor(I.servidor).then(function(){I.Ip=I.servidor.Ip}).then(function(){l()})})}function f(){i.show(),t.when(I.Ip).then(function(){s.findByValue(I.Ip).then(function(o){var t=o.Ip+":"+o.Porta;return c.findByValue(t).then(function(o){o&&c.deleteServidor(o).then(function(){n(function(){e.location.reload(!0)},1e3)})}),o}).then(function(o){s.deleteServidor(o).then(function(){s.allServidores().then(function(o){return o}).then(function(o){I.servidores=[],I.servidores=o,0==I.servidores.length&&c.limparServidores().then(function(){n(function(){e.location.reload(!0)},1e3)})}).then(function(){n(function(){I.Ip="",i.hide()},1e3)})})})})}function h(){I.mensagem=[],""==I.servidor.Ip&&I.mensagem.push("O IP é Obrigatório"),""==I.servidor.Porta&&I.mensagem.push("A Porta é Obrigatório")}function v(){I.mensagem=[]}function g(){return I.mensagem=[],""==I.Ip?(I.mensagem.push("Nenhum IP foi especificado"),!1):r.show({title:"Atenção",template:"Deseja excluir esse Servidor?",scope:a,buttons:[{text:"Não",type:"button-calm"},{text:"Sim",type:"button-assertive",onTap:function(o){f()}}]})}function C(){return r.show({title:"Novo Servidor",template:b(),scope:a,buttons:[{text:"Cancelar",type:"button-calm"},{text:"Salvar",type:"button-positive",onTap:function(o){if(h(),!(I.mensagem.length>0))return p();o.preventDefault()}}]})}function b(){var o="";return o+='<div class="item item-assertive" ng-show="vm.mensagem.length > 0">',o+="<ul>",o+='<li ng-repeat="item in vm.mensagem">{{ item }}</li>',o+="</ul>",o+="</div>",o+='<label class="item item-input item-stacked-label">',o+='<span class="input-label">IP do Servidor</span>',o+='<input type="text" name="Ip" ng-model="vm.servidor.Ip" ng-change="vm.LimparMensagem()" autofocus />',o+="</label>",o+='<label class="item item-input item-stacked-label">',o+='<span class="input-label">Porta do Servidor</span>',o+='<input type="text" name="Porta" ng-model="vm.servidor.Porta" ng-change="vm.LimparMensagem()" />',o+="</label>"}var I=this;I.servidores=[],I.servidor={},I.selecionado={},I.index="",I.mensagem=[],I.host="",I.Ip="",I.init=d,I.selecionar=l,I.novo=m,I.salvar=p,I.excluir=f,I.validarDados=h,I.LimparMensagem=v,I.PopUpConfirmarExclusao=g,I.PopUpNovoServidor=C,I.TemplateNovoServidor=b,d()}angular.module("sied.controllers").controller("ConfigCtrl",o),o.$inject=["$log","$window","$q","$timeout","$scope","$ionicLoading","$ionicPopup","DataFactory","ServidorFactory","HostFactory"]}(),function(){"use strict";function o(o,e,t,n,a,i,r,s){function c(){a.show(),e.when(m.caixa).then(l())}function u(){a.show(),m.caixa=[],i.async("GetVendaEmConsumoCaixa").then(function(o){a.show({template:"Carregando Vendas em Caixa"}),m.caixa=o,t(function(){a.hide()},1e3)})}function d(){a.show(),m.consumo=[],i.async("GetVendaEmConsumo").then(function(o){a.show({template:"Carregando Vendas em Consumo"}),m.consumo=o,t(function(){a.hide()},1e3)})}function l(){e.when(m.caixa).then(u()).then(d())}var m=this;m.titulo="Vendas em Consumo",m.controlador="ConsumoCtrl",m.metodo="",m.caixa=[],m.consumo=[],m.init=c,m.GerarRelatorio=l,m.GetVendaEmConsumoCaixa=u,m.GetVendaEmConsumo=d,n.$on("EventLogin",c())}angular.module("sied.controllers").controller("ConsumoCtrl",o),o.$inject=["$log","$q","$timeout","$scope","$ionicLoading","ClientAPIFactory","TratarDataService","TratarObjetosService"]}(),function(){"use strict";function o(o,e,t,n,a,i,r,s,c){function u(){h.dataInicial=r.SubtrairDataSemFormato(1),h.dataFinal=new Date,d()}function d(){a.show(),e.when(h.dataFinal).then(p()).then(f())}function l(){for(var o=h.fechados,e=0,t=s.ContarObjetos(o[0]),n=0;n<t;)e+=c.ConverterParaFloat(o[0][n].Total),n++;h.totalFechados=e,h.totalGeral=h.totalFechados}function m(){for(var o=h.consumos,e=0,t=s.ContarObjetos(o[0]),n=0;n<t;)e+=c.ConverterParaFloat(o[0][n].Total),n++;h.totalConsumos=e,h.totalGeral=h.totalGeral+h.totalConsumos,h.totalFechados.toFixed(2),h.totalFechados.toFixed(2),h.totalGeral.toFixed(2),h.totalGeral=c.ConverterParaString(h.totalGeral),h.totalConsumos=c.ConverterParaString(h.totalConsumos),h.totalFechados=c.ConverterParaString(h.totalFechados)}function p(){a.show(),h.fechados=[],h.totalFechados=0;var o=r.formatarDataHora(h.dataInicial),e=r.formatarDataHora(h.dataFinal);i.async("GetRetornaCouvertFechado/"+o+"/"+e).then(function(o){a.show({template:"Carregando Couvert Fechado"}),h.fechados=o,s.ContarObjetos(h.fechados[0])>0&&l(),t(function(){a.hide()},1e3)})}function f(){a.show(),h.consumos=[],h.totalConsumos=0,i.async("GetRetornaCouvertMovimento").then(function(o){a.show({template:"Carregando Couvert em Movimento"}),h.consumos=o,s.ContarObjetos(h.consumos[0])>0&&m(),t(function(){a.hide()},1e3)})}var h=this;h.dataInicial="",h.dataFinal="",h.fechados=[],h.consumos=[],h.totalGeral=0,h.totalConsumos=0,h.totalFechados=0,h.init=u,h.GerarCouvert=d,h.GetRetornaCouvertFechado=p,h.GetRetornaCouvertMovimento=f,n.$on("EventLogin",u())}angular.module("sied.controllers").controller("CouvertCtrl",o),o.$inject=["$log","$q","$timeout","$scope","$ionicLoading","ClientAPIFactory","TratarDataService","TratarObjetosService","TratarFloatService"]}(),function(){"use strict";function o(o,e,t,n,a,i,r){function s(){c(),v.grupo=0,v.tipo=0,l()}function c(){i.async("GetGrupoDeProduto").then(function(o){v.grupos=[],v.grupos=o,r.ContarObjetos(v.grupos)>0&&v.grupos[0].unshift({Codigo:0,Grupo:"Todos"})})}function u(){v.data={},v.data.tipo=v.tipo;f()}function d(){v.data={},v.data.grupo=v.grupo;h()}function l(){t.show();var n={grupo:v.grupo,tipo:v.tipo};v.relatorio=!1,v.dados=[],o.when(n).then(function(o){var n="";switch(o.tipo){case 0:n=0;break;case 1:n="EstoqueZero";break;case 2:n="AbaixoEstoqueMinimo";break;case 3:n="AbaixoPontoPedido";break;case 4:n="AbaixoEstoquePadrao"}i.async("GetEstoque/"+o.grupo+"/"+n).then(function(o){t.show({template:"Carregando Estoque"}),v.dados=o,r.ContarObjetos(v.dados[0])>0&&(v.relatorio=!0),e(function(){t.hide()},1e3)})})}function m(){for(var o=0,e=v.tipos.length,t="<ion-list>";o<e;)t+='<ion-radio ng-model="vm.data.tipo" ng-value="'+v.tipos[o].id+'" style="font-size: 12px;">'+v.tipos[o].descricao+"</ion-radio>",o++;return t+="</ion-list>"}function p(){for(var o=0,e=r.ContarObjetos(v.grupos[0]),t="<ion-list>";o<e;)t+='<ion-radio ng-model="vm.data.grupo" ng-value="'+v.grupos[0][o].Codigo+'" style="font-size: 12px;" >'+v.grupos[0][o].Grupo+"</ion-radio>",o++;return t+="</ion-list>"}function f(){return a.show({template:m(),title:"Informar o Tipo de Relatório",scope:n,buttons:[{text:"<b>Gerar Relatório</b>",type:"button-balanced",onTap:function(o){v.tipo=v.data.tipo,l()}}]})}function h(){return a.show({template:p(),title:"Informar o Grupo",scope:n,buttons:[{text:"<b>Selecionar Grupo</b>",type:"button-balanced",onTap:function(o){v.grupo=v.data.grupo,l()}}]})}var v=this;v.titulo="Controle de Estoque",v.relatorio=!1,v.tipo=0,v.grupo=0,v.dados=[],v.grupos=[],v.tipos=[{id:0,descricao:"Todos"},{id:1,descricao:"Estoque Zero"},{id:2,descricao:"Abaixo do Estoque Mínimo"},{id:3,descricao:"Abaixo do Ponto de Pedido"},{id:4,descricao:"Abaixo do Estoque Padrão"}],v.init=s,v.LoadGrupos=c,v.SetTipo=u,v.SetGrupo=d,v.TemplateSetTipo=m,v.TemplateSetGrupo=p,v.PopUpSetTipo=f,v.PopUpSetGrupo=h,v.GerarRelatorio=l,n.$on("EventLogin",s())}angular.module("sied.controllers").controller("EstoqueCtrl",o),o.$inject=["$q","$timeout","$ionicLoading","$scope","$ionicPopup","ClientAPIFactory","TratarObjetosService"]}(),function(){"use strict";function o(o,e,t,n,a,i,r,s,c){function u(){a.show(),h.dataFinal=new Date,o.when(h.dataFinal).then(function(){h.dataInicial=c.SubtrairDataSemFormato(1)}).then(function(){f()})}function d(o){r.copy(o).then(function(){console.log(o)})}function l(o){var e="<strong> Título: "+o.Titulo+"<br />";return e+="<strong> Fornecedor: "+o.Fornecedor+"<br />",e+="<strong> Valor: "+o.Valor+"<br />",e+="<strong> Vencimento: "+o.Vencimento,""!==o.Barra&&(e+="<br /><strong>Cod.Barra: </strong>"+o.Barra.substring(0,18)),e}function m(o){return i.show({title:"Copiar Código de Barra",template:l(o),buttons:[{text:"Sair",type:"button-calm"},{text:"Copiar",type:"button-balanced",onTap:function(e){e&&d(o.Barra)}}]})}function p(o){if(""!=o.Titulo||""!=o.Fornecedor||""!=o.Vencimento){m(o)}}function f(){a.show();var o={d1:c.formatarDataAPI(h.dataInicial),d2:c.formatarDataAPI(h.dataFinal)};h.dados=[],s.async("GetContasAPagar/"+o.d1+"/"+o.d2).then(function(o){a.show({template:"Carregando Financeiro"}),h.dados=o}).then(function(){e(function(){a.hide()},1e3)})}var h=this;h.titulo="Financeiro",h.dados=[],h.relatorio=!1,h.dataInicial="",h.dataFinal="",h.init=u,h.copiarTexto=d,h.pegarCodigoDeBarra=p,h.GerarRelatorio=f,n.$on("EventLogin",u())}angular.module("sied.controllers").controller("FinanceiroCtrl",o),o.$inject=["$q","$timeout","$log","$scope","$ionicLoading","$ionicPopup","$cordovaClipboard","ClientAPIFactory","TratarDataService"]}(),function(){"use strict";function o(o,e,t,n){function a(){t.toggleLeft()}function i(){s.cnpj=n.getCnpj()}function r(){e.confirm({title:"Atenção",template:"Tem certeza que deseja sair do sistema?"}).then(function(o){o&&ionic.Platform.exitApp()})}var s=this;s.titulo="Managing 2017",s.cnpj="CNPJ",s.ConfirmarSaida=r,s.toggleLeft=a,s.init=i,i(),o.registerBackButtonAction(function(o){r()},100)}angular.module("sied.controllers").controller("InicioCtrl",o),o.$inject=["$ionicPlatform","$ionicPopup","$ionicSideMenuDelegate","HostFactory"]}(),function(){"use strict";function o(o,e,t,n,a,i,r,s,c){function u(){p()}function d(o){G.index=o,G.swiper.slideTo(o)}function l(o){return 0==o?G.slide=[{Evento:"vm.MudarSlide(0)",Icone:"ion-android-settings",Nome:"Configuração",Index:8,Template:"templates/tab-config.html"},{Evento:"vm.MudarSlide(1)",Icone:"ion-happy-outline",Nome:"Sobre Nós",Index:9,Template:"templates/tab-sobre.html"}]:(G.slide=[{Evento:"vm.MudarSlide(0)",Icone:"ion-ios-home",Nome:"Início",Index:0,Template:"templates/tab-inicio.html"},{Evento:"vm.MudarSlide(1)",Icone:"ion-social-usd",Nome:"Caixa",Index:1,Template:"templates/tab-caixa.html"},{Evento:"vm.MudarSlide(2)",Icone:"ion-cash",Nome:"Vendas",Index:2,Template:"templates/tab-vendas.html"},{Evento:"vm.MudarSlide(3)",Icone:"ion-beer",Nome:"Vendas em Consumo",Index:3,Template:"templates/tab-consumo.html"},{Evento:"vm.MudarSlide(4)",Icone:"ion-clipboard",Nome:"Estoque",Index:4,Template:"templates/tab-estoque.html"},{Evento:"vm.MudarSlide(5)",Icone:"ion-sad-outline",Nome:"Cancelamentos",Index:5,Template:"templates/tab-cancelamentos.html"},{Evento:"vm.MudarSlide(6)",Icone:"ion-calculator",Nome:"Financeiro",Index:6,Template:"templates/tab-financeiro.html"},{Evento:"vm.MudarSlide(7)",Icone:"ion-ios-cart",Nome:"Compras",Index:7,Template:"templates/tab-compras.html"},{Evento:"vm.MudarSlide(8)",Icone:"ion-mic-a",Nome:"Couvert",Index:8,Template:"templates/tab-couvert.html"},{Evento:"vm.MudarSlide(9)",Icone:"ion-android-settings",Nome:"Configurar Servidores",Index:9,Template:"templates/tab-config.html"},{Evento:"vm.MudarSlide(10)",Icone:"ion-happy-outline",Nome:"Sobre Nós",Index:10,Template:"templates/tab-sobre.html"}],G.slide)}function m(o){G.menu=[],G.slide=[];var e=l(o),t=e.length,n=0;for(G.menu.push({Evento:"vm.preLogin()",Icone:"ion-locked",Nome:"Login",Index:"",Template:""});n<t;)G.menu.push({Evento:e[n].Evento,Icone:e[n].Icone,Nome:e[n].Nome,Template:e[n].Template}),n++;G.menu.push({Evento:"vm.Sair()",Icone:"ion-power",Nome:"Sair",Index:"",Template:""})}function p(){s.initDB(),s.lastServidor().then(function(o){if(!o||0===o.length)return G.checarLogin=!0,void m(0);G.host=o[0],i.setConfig(G.host.servidor),w()})}function f(){var o=G.dados.usuario;G.usuario=G.usuarios[0][o],$(),G.popup.close()}function h(){G.mensagem=[],""==G.dados.senha&&G.mensagem.push("O campo Senha é obrigatório"),G.dados.senha!=G.usuario.Senha&&G.mensagem.push("A senha informada é inválida")}function v(){var o="";return o+='<div class="item item-assertive" ng-show="vm.mensagem.length > 0">',o+="<ul>",o+='<li ng-repeat="item in vm.mensagem">{{ item }}</li>',o+="</ul>",o+="</div>",o='<input ng-model="vm.dados.senha" type="number" autofocus ng-change="vm.LimparMensagem()"/>'}function g(o){for(var e="",t=0;t<o;)e+='<ion-radio ng-model="vm.dados.usuario" ng-value="'+t+'" ng-click="vm.SelecionarUsuario()">'+G.usuarios[0][t].Nome+"</ion-radio>",t++;return e}function C(){return n.show({title:"Informe a senha",template:v(),scope:t,buttons:[{text:"Sair",type:"button-assertive",onTap:function(o){ionic.Platform.exitApp()}},{text:"Voltar",type:"button-positive",onTap:function(o){w()}},{text:"Entrar",type:"button-balanced",onTap:function(o){if(h(),!(G.mensagem.length>0))return I();b()}}]})}function b(){var o="",e=0;for(o="<ul>";e<G.mensagem.length;)o+="<li>"+G.mensagem[e]+"</li>",e++;return o+="</ul>",n.alert({title:"Atenção",template:o,buttons:[{text:"Tente Novamente",type:"button-balanced",onTap:function(o){return o.preventDefault(),C()}}]})}function I(){h(),G.mensagem.length>0||(r.setParams(G.usuario),m(1),G.checarLogin=!0,t.$emit("EventLogin",P(G.usuario)))}function S(){G.mensagem=[]}function x(o){return n.show({title:"Selecione o usuario",template:g(o),scope:t})}function w(){G.checarLogin=!1,G.dados.usuario="",a.asyncLogin("GetLogin").then(function(o){G.usuarios=o}).then(function(o,e){if(!G.usuarios){m(0);var t="Não existe servidor disponível";if(G.host.servidor)var t="O servidor "+G.host.servidor+" está indisponível";return void n.alert({title:"Atenção",template:t}).then(function(o){d(0)})}var a=c.ContarObjetos(G.usuarios[0]);G.popup=x(a)}).then(function(){a.async("GetRetornaCnpjDaEmpresa").then(function(o){i.setCnpj(o[0])})})}function P(o){G.usuario=o}function $(){G.dados.senha="";C()}function T(){0!==t.index&&(G.index=t.index-1,d(t.index))}function y(){ionic.Platform.exitApp()}var G=this;G.host={},G.hide=!1,G.index=0,G.selecionado={},G.dados={usuario:"",senha:""},G.mensagem=[],G.servidores=[],G.usuarios=[],G.usuario={},G.menu=[],G.popup="",G.checarLogin=!1,G.dashboard={swiper:!1,slider:!1,activeIndexView:0},G.MudarSlide=d,G.ConfigurarServidor=p,G.SelecionarUsuario=f,G.LimparMensagem=S,G.validarDados=h,G.Voltar=T,G.Sair=y,G.init=u,G.login=$,G.preLogin=w,u(),t.$on("$ionicSlides.sliderInitialized",function(o,e){e&&e.slider&&(G.swiper=e.slider)}),t.$on("$ionicSlides.slideChangeStart",function(o,e){!e||!e.slider||!e.slider.snapIndex<0||(t.$$phase?G.dashboard.activeIndexView=e.slider.snapIndex:t.$apply(function(){G.dashboard.activeIndexView=e.slider.snapIndex}))})}angular.module("sied.controllers").controller("PrincipalCtrl",o),o.$inject=["$q","$log","$scope","$ionicPopup","ClientAPIFactory","HostFactory","UsuarioFactory","ServidorFactory","TratarObjetosService"]}(),function(){"use strict";function o(o,e,t){var n=this;n.titulo="SobreNos",n.Empresa={Nome:"Sied Sistemas",Cnpj:"03.367.362/0001-03",CEP:"77000-000",Logradouro:"501 Sul, Av. Teotônio Segurado, Conj. 01",Complemento:"Lt. 03, Ed. Executive Center, Sala 403",Bairro:"Plano Diretor Sul",Numero:"s/n",Cidade:"Palmas",Estado:"TO",T_Empresa:"(63) 3322-9404",T_Vendas:"",T_Suporte:"(63) 98446-0444",Email:"odair@siedsistemas.com.br",Site:"siedsistemas.com.br",Ano_Abertura:"1998"}}angular.module("sied.controllers").controller("SobreCtrl",o),o.$inject=["$ionicPlatform","$ionicPopup","$ionicSideMenuDelegate"]}(),function(){"use strict";function o(o,e,t,n,a,i,r,s,c,u){function d(){$.tipo=1;var o=$.tipo;e.when(o).then(function(){r.async("GetHoraPadrao").then(function(o){$.p1=o[0][0].HoraInicial,$.p2=o[0][0].HoraFinal,w()}).then(function(){C()})})}function l(){$.dados=[],$.rodape=[],C()}function m(){5!==$.tipo&&C()}function p(){5!==$.tipo&&C()}function f(o){return 2===o?"GetVendaPorProduto":3===o?"GetVendaPorGrupoProduto":4===o?"GetVendaGraficoPorVendedor":5===o?"GetVendaGraficoAnual":void 0}function h(){a.hide();var o=new Date;$.data={},$.data.ano=o.getFullYear();x()}function v(){if(4==$.tipo)for(var o=0,e=c.ContarObjetos($.dados[0]);o<e;)$.data[[o]]=u.ConverterParaFloat($.dados[0][o].Venda),$.labels[o]=$.dados[0][o].Vendedor.substring(0,3),o++;$.detalhes=[]}function g(o){if(a.show(),$.detalhes=[],4!=$.tipo)return r.async("GetTotalVendaPorComanda/"+o.d1+"/"+o.d2).then(function(o){a.show({template:"Carregando Vendas Por Comanda"}),$.detalhes=o,t(function(){a.hide()},1e3)}),o}function C(){a.show(),$.labels=[],$.data=[],$.dados=[];var o=f($.tipo);if(5===$.tipo)return void h();var n={d1:s.formatarDataHora($.dataInicial),d2:s.formatarDataHora($.dataFinal)};4===$.tipo&&(n.d1=s.formatarDataAPI($.dataInicial),n.d2=s.formatarDataAPI($.dataFinal),$.series=["Venda R$"]),e.when(n).then(function(e){return $.tipo>1&&r.async(o+"/"+e.d1+"/"+e.d2).then(function(o){a.show({template:"Carregando"}),$.dados=o,c.ContarObjetos($.dados)>0&&($.series=["Ano"],v()),t(function(){a.hide()},1e3)}),e}).then(function(o){return g(o),o}).then(function(o){return I(o.d1,o.d2),o}).then(function(){$.relatorio=!0})}function b(o){a.show(),$.labels=[],$.data=[],$.detalhes=[],$.dados=[],$.mostrarRodape=!1,r.async("GetVendaGraficoAnual/"+o).then(function(o){a.show({template:"Gerando Gráfico"}),$.dados=o,c.ContarObjetos($.dados[0])>0&&P(),t(function(){a.hide()},1e3)})}function I(o,e){a.show(),$.rodape=[],5!=$.tipo&&r.async("GetCalculaRodapeVenda/"+o+"/"+e).then(function(o){a.show({template:"Calculando Relatório de Vendas"}),$.rodape=o,c.ContarObjetos($.rodape)>0&&($.mostrarRodape=!0),t(function(){a.hide()},1e3)})}function S(){var o='<div class="list">';return o+='<label class="item item-input">',o+='<span class="input-label">Informar o ano: </span>',o+='<input type="number" ng-model="vm.data.ano" >',o+="</label>",o+="</div>"}function x(){return i.show({template:S(),title:"Informar o Ano",scope:n,buttons:[{text:"<b>Gerar Gráfico</b>",type:"button-balanced",onTap:function(o){$.data.ano?b($.data.ano):o.preventDefault()}}]})}function w(){var o=$.p1.split(":"),e=$.p2.split(":");$.dataInicial=s.SubtrairDataSemFormato(1),$.dataInicial.setHours(o[0]),$.dataInicial.setMinutes(o[1]),$.dataInicial.setSeconds(o[2]),$.dataFinal=new Date,$.dataFinal.setHours(e[0]),$.dataFinal.setMinutes(e[1]),$.dataFinal.setSeconds(e[2])}function P(){for(var o=0,e=0,t=c.ContarObjetos($.dados[0]),n=0;n<t;)$.data[[n]]=u.ConverterParaFloat($.dados[0][n].Valor),$.labels[n]=$.dados[0][n].Mes.substring(0,3),o=u.ConverterParaFloat($.dados[0][n].Valor),e+=o,n++;$.totalAno=u.ConverterParaString(e.toFixed(2))}var $=this;$.ano="",$.totalAno=0,$.titulo="Relatório de Vendas",$.mostrarRodape=!1,$.tipo="",$.dataInicial="",$.dataFinal="",$.p1="",$.p2="",$.colors=["rgb(159,204,0)"],$.dados=[],$.labels=[],$.series=[],$.data=[],$.tipos=[{id:1,descricao:"Geral"},{id:3,descricao:"Por Grupo de Produtos"},{id:4,descricao:"Por Vendedor"},{id:5,descricao:"Gerar Gráfico Anual"}],$.detalhes=[],$.rodape=[],$.init=d,$.Refresh=l,$.SetDataInicial=m,$.SetDataFinal=p,$.RetornarMetodo=f,$.GetAno=h,$.GetVenda=C,$.GerarGraficoPorAno=b,$.GerarRodape=I,$.TemplateGetAno=S,$.PrepararDatas=w,$.CalcularTotalAno=P,n.$on("EventLogin",d())}angular.module("sied.controllers").controller("VendasCtrl",o),o.$inject=["$log","$q","$timeout","$scope","$ionicLoading","$ionicPopup","ClientAPIFactory","TratarDataService","TratarObjetosService","TratarFloatService"]}();