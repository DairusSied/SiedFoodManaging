<div ng-controller="ComprasCtrl as vm">
  <ion-header-bar class="bar bar-header cabecalho_interno">
    <ion-nav-title>{{ vm.titulo }}</ion-nav-title>
    <ion-nav-bar class="bar-light cabecalho_interno">
      <ion-nav-buttons side="left">
        <button class="button button-positive icon ion-android-refresh"
                style="margin-right: 0px !important;"
                ng-click="vm.RetornarProdutosByPrecoCompra()" ng-show="vm.relatorio"> Atualizar
        </button>
      </ion-nav-buttons>
      <ion-nav-buttons side="right">
        <button class="button button-positive icon ion-ios-arrow-back"
                ng-hide="vm.relatorio" style="margin-right: 0px;" ng-hide="!vm.cabecalho[0].length" ng-click="vm.Voltar()"> Voltar</button>
      </ion-nav-buttons>
    </ion-nav-bar>
  </ion-header-bar>
  <ion-content class="has-footer">
    <div class="padding">
      <div class="card mb" ng-hide="vm.relatorio">
        <ion-list>
          <ion-item class="item item-divider">
            {{ vm.cabecalho[0][0].Produto }}
          </ion-item>
          <ion-item>
            <table class="tabela mt">
              <tr>
                <td><strong>Custo Médio</strong></td>
                <td align="right">{{ vm.cabecalho[0][0].CustoMedio }}</td>
              </tr>
              <tr>
                <td><strong>Preço de Venda</strong></td>
                <td align="right">{{ vm.cabecalho[0][0].PrecoVenda }}</td>
              </tr>
              <tr>
                <td><strong>Unidades</strong></td>
                <td align="right">{{ vm.cabecalho[0][0].Und }}</td>
              </tr>
              <tr>
                <td><strong>Estoque Atual</strong></td>
                <td align="right">{{ vm.cabecalho[0][0].Estoque }}</td>
              </tr>
              <tr>
                <td><strong>Estoque Mínimo</strong></td>
                <td align="right">{{ vm.cabecalho[0][0].EstoqueMinimo }}</td>
              </tr>
              <tr>
                <td><strong>Estoque Padrão</strong></td>
                <td align="right">{{ vm.cabecalho[0][0].EstoquePadrao }}</td>
              </tr>
              <tr>
                <td><strong>Estoque p/ Pedido</strong></td>
                <td align="right">{{ vm.cabecalho[0][0].EstoquePontoPedido }}</td>
              </tr>
            </table>
          </ion-item>
          <ion-item ng-hide="!vm.detalhes[0].length">
            <table class="tabela mt">
              <tr>
                <td><strong>Fornecedor</strong></td>
                <td><strong>Data</strong></td>
                <td align="right"><strong>Qtde</strong></td>
                <td align="right"><strong>P.Compra</strong></td>
              </tr>
              <tr ng-repeat="item in vm.detalhes[0]">
                <td>{{ item.Fornecedor | limitTo:12}}</td>
                <td>{{ item.Data }}</td>
                <td align="right">{{ item.Qtde }}</td>
                <td align="right">{{ item.PrecoCompra }}</td>
              </tr>
            </table>
          </ion-item>
        </ion-list>
      </div>
      <div ng-show="vm.relatorio" class="card">
        <div class="card">
          <ion-list>
            <ion-item class="item item-divider">
              Detalhes dos Produtos
            </ion-item>
            <label class="item item-input label-pesqusa">
              <i class="icon ion-ios-search placeholder-icon"></i>
              <input class="input-pesquisa" type="search" ng-model="vm.pesquisa.Produto" placeholder="Filtrar Produtos">
            </label>
            <ion-item class="item-content" ng-repeat="item in vm.dados[0] | filter: vm.pesquisa" ng-click="vm.RetornarDetalhesDoItem(item)">
              {{ item.Produto }}
              <div class="row without-margin without-padding" style="padding-left: 0px; margin-left: 0px;">
                <div class="col" style="padding-left: 0px; margin-left: 0px;">
                  <strong>Est. Atual</strong>
                </div>
                <div class="col">
                  <strong>Pr. Compra</strong>
                </div>
                <div class="col">
                  <strong>Pr. Venda</strong>
                </div>
              </div>
              <div class="row without-margin without-padding" style="padding-left: 0px; margin-left: 0px;">
                <div class="col" style="padding-left: 0px; margin-left: 0px;">
                  {{ item.Estoque }}
                </div>
                <div class="col">
                  {{ item.Compra }}
                </div>
                <div class="col">
                  {{ item.Venda }}
                </div>
              </div>
            </ion-item>
          </ion-list>
        </div>
      </div>
    </div>
</div>
